factor.wge(phi=c(1.445, -.411, -.038, .170, .362, -.245, -.177, .213))
(1/2pi)
pi
1/(2*pi)
(1/(2*pi))
(1/(2*pi))*acos((-.5)/2*sqrt(.6))
(1/(2*pi))*acos((-.5)/(2*sqrt(.6)))
acos((-.5)/(2*sqrt(.6)))
library(tswge)
plotts.true.wge(phi=c(0.1516, 0.0769, 0.0016, -0.0095, 0.0542, 0.1117, 0.5683))
plotts.true.wge(phi=c(0.1529, 0.0988, 0.0059, -0.0075, 0.0538, 0.1118, 0.5717, 0.0034, -0.0382 )
)
plotts.true.wge(phi=c(.4295, .1769, .0358, .1454 )
)
plotts.true.wge(phi=c(0.1516, 0.0769, 0.0016, -0.0095, 0.0542, 0.1117, 0.5683))
plotts.true.wge(phi=c(0.1516, 0.0769, 0.0016, -0.0095, 0.0542, 0.1117, 0.5683))
??htmlParse
??htmlParse()
load("C:/Users/anhai/Desktop/SMU/7333_QTW/7333_QTW/Case_Study_4/CBMenTextTables.rda")
View(menTables)
menTables[["1999"]]
library(tsgwe)
library(tswge)
psi.weights.wge(phi=c(1.95, -1.9), lag.max = 4)
head(bitcoin)
aic5.wge(bitcoin$Close)
?plotts.true.wge
library(readr)
Walmart <- read_csv("C:/Users/anhai/Desktop/SMU/6373_Time_Series/2/Walmart.csv")
View(Walmart)
save.image("C:/Users/anhai/Desktop/SMU/6373_Time_Series/TimeSeries.RData")
View(fake.data)
rm(model1)
rm(model2)
rm(fake.data)
rm(fake.data2)
rm(x)
rm(y)
rm(xfit)
rm(yfit)
rm(test)
rm(gender)
rm(sresid)
stor9item50 <- subset(Walmart[(Walmart$store == 9) && (Walmart$item == 50)])
subset(Walmart[(Walmart$store == 9) && (Walmart$item == 50)])
subset(Walmart[(Walmart$store == 9)])
subset(Walmart[,(Walmart$store == 9)])
subset(Walmart[(Walmart$store == 9),])
subset(Walmart[(Walmart$store == 9) && (Walmart$item == 50),])
subset(Walmart[(Walmart$store == 9) & (Walmart$item == 50),])
stor9item50 <- subset(Walmart[(Walmart$store == 9) & (Walmart$item == 50),])
save.image("C:/Users/anhai/Desktop/SMU/6373_Time_Series/TimeSeries.RData")
aic5.wge(stor9item50$sales)
factor.wge(theta=c(.8,-.5))
factor.wge(phi=c(.8,-.5))
factor.wge(phi=c(-.8,.5))
plotts.true.wge(100, phi=c(1.6, -0.9, .5), theta=c(0.4, -.87))
plotts.true.wge(100, phi=c(1.6, -0.9), theta=c(0.4, -.87))
library(readr)
swadelay <- read_csv("C:/Users/anhai/Desktop/SMU/6373_Time_Series/5/swadelay.csv")
View(swadelay)
plotts.sample.wge(swadelay$arr_cancelled)
aic5.wge(swadelay$arr_cancelled)
??readLines
?readLines
library(isis)
data(isis)
library("isis")
data("iris")
iris
glm(iris)
??naive.bayes
library(e1071)
naiveBayes(iris)
?naiveBayes
nbmodel <- naiveBayes(Species ~ ., data=iris)
nbmodel
??glmmet
??glmnet
?glmnet
library(glmnet)
install.packages("glmnet")
?glmnet
??glmnet
?glmnet_beta
library(glmnet)
?glmnet
?glm
?glmnet
library(tswge)
plotts.true.wge(theta=c(.8,-.5))$auth1
plotts.true.wge(theta=c(.8,-.5))$auth1
plotts.true.wge(theta=c(.8,-.5))
plotts.true.wge(theta=c(.8,-.5))$aut1
??artrans.wge
librar(tswge)
library(tswge)
ar1 <- mult.wge(fac1=c(.6,-.8), fac2=1)
factor.wge(ar1)
ar1
factor.wge(ar1$model.coef)
arima1 <- gen.arima.wge(n=500, phi=.6,-.8, theta=-.3, d=2)
arima1 <- gen.arima.wge(n=500, phi=.6,-.8, theta=-.3, d=2, vara=1)
arima1 <- gen.arima.wge(n=500, phi=.6,-.8, theta=-.3, d=2, vara=1, sn=37)
parzen.wge(arima1)
arima2 <- gen.arima.wge(n=500, phi=.6,-.8, theta=-.3, d=2, vara=1, sn=35)
arima2diff1 <- artrans.wge(arima2, 1)
arima2diff2 <- artrans.wge(arima2diff1,1)
aic5.wge(arima2diff2)
arima2 <- gen.arima.wge(n=500, phi=c(.6,-.8), theta=-.3, d=2, vara=1, sn=35)
arima2diff1 <- artrans.wge(arima2, 1)
arima2diff2 <- artrans.wge(arima2diff1,1)
aic5.wge(arima2diff2)
aic5.wge(arima2diff1)
aic5.wge(arima2diff2)
arima2 <- gen.arima.wge(n=500, phi=c(.6,-.8), theta=-.3, d=2, sn=35)
aic5.wge(arima2diff1)
arima2diff1 <- artrans.wge(arima2, 1)
arima2diff2 <- artrans.wge(arima2diff1,1)
aic5.wge(arima2diff1)
arima2 <- gen.arima.wge(n=500, phi=c(.6,-.8), theta=c(-.3), d=2, sn=35)
?gen.arima.wge
ar2 <- mult.wge(fac1=c(.6,-.8), fac2=1, d=2)
?mult.wge
ar2 <- mult.wge(fac1=c(.6,-.8), fac2=1)
ar2
arima2 <- gen.arima.wge(n=500, phi=ar2$model.coef, theta=c(-.3), d=2, sn=35)
arima2 <- gen.arima.wge(n=500, phi=c(.6,-.8), theta=c(-.3), d=2, sn=35)
arima2 <- gen.arima.wge(n=500, phi=c(.6,-.8), d=2, sn=35)
arima2diff1 <- artrans.wge(arima2, 1)
arima2diff2 <- artrans.wge(arima2diff1,1)
aic5.wge(arima2diff2)
plotts.true.wge(arima2diff2)
arima2diff2
plotts.true.wge(arima2diff2)
?plotts.true.wge
plotts.true.wge(n=100, arima2diff2)
aic5.wge(arima2diff2)
gen.aruma.wge(n=200, phi=c(.6, -.94), s=6, theta=-.3,sn=19)
2**2
1-.99**2
1/(1-.99**2)
(1/(1-.99**2))*4
(1/(1-.99**2))*2
((2**2)/(1-.99**2))
((2**2)/(1-.4**2))
(2**2)/(1-(.4**2))
(2**2)/(1-(.99**2))
(2**2)/(1-(.4**2))
(2)/(1-(.4**2))
(4)/(1-(.99**2))
(2)/(1-(.99**2))
(4)/(1-(.4**2))
sqrt((4)/(1-(.4**2)))
?gen.arma.wge()
library(tswge)
?gen.arma.wge()
gen.arma.wge(n=100, phi=c(1.6,-.9), theta=.8, vara=1, plot=TRUE)
x=gen.arum.wge(sn=37, x=500, theta=c(.3,-.7), s=12, phi=c(.6,-.8))
x=gen.aruma.wge(sn=37, x=500, theta=c(.3,-.7), s=12, phi=c(.6,-.8))
?gen.aruma.wge
x=gen.aruma.wge(sn=37, n=500, theta=c(.3,-.7), s=12, phi=c(.6,-.8))
xdif<-artrans.wge(x, c(rep(0,11),1))
aic5.wge(xdif)
aic5.wge(xdif, p=4:10)
aic5.wge(xdif, p=4:10, q=0:5)
xdif2<-artrans.wge(xdif, c(rep(0,11),1))
aic5.wge(xdif2, p=4:10, q=0:5)
aic5.wge(xdif2)
x=gen.aruma.wge(sn=37, n=500, theta=c(.3,-.7), s=12, phi=c(.6,-.8))
xdif<-artrans.wge(x, c(rep(0,11),1))
xdif2<-artrans.wge(xdif, c(rep(0,11),1))
aic5.wge(xdif2)
x<-c(-.5,.2,-1,.5,-.2)
factor.wge(phi=x)
x<-c(-.5,.2,0,-1,.5,-.2)
factor.wge(phi=x)
factor.wge(phi=c(0,0,0,1))
factor.wge(phi=c(0,0,0,0,0,1))
factor.wge(phi=c(rep(0,11)1))
factor.wge(phi=c(rep(0,11),1))
x1<-c(-.3,1.2,.4,0,.5,0,0,0,0,0,0,-1,.3,-1.2,-.4)
factor.wge(phi=x1
)
x1<-c(-1,-.3,1.2,.4,0,.5,0,0,0,0,0,0,-1,.3,-1.2,-.4)
factor.wge(phi=x1)
x1<-c(1,-.3,1.2,.4,0,.5,0,0,0,0,0,0,-1,.3,-1.2,-.4)
factor.wge(phi=x1)
x<-c(1,-.5,.2,0,-1,.5,-.2)
factor.wge(phi=x)
factor(c(0,0,0,1))
factor.wge(c(0,0,0,1))
x<-c(-.5,.2,0,-1,.5,-.2)
factor.wge(phi=x)
x1<-c(1,-.3,1.2,.4,0,.5,0,0,0,0,0,0,-1,.3,-1.2,-.4)
factor.wge(phi=x1)
factor.wge(phi=c(rep(0,5),1))
factor.wge(phi=c(rep(0,11),1))
factor.wge(phi=x1)
?sample
sample(3,2)
sample(10,5)
?floor
floor(5)
floor(6)
floor(6.7)
floor(6.9)
ceiling(6.7)
ceiling(6.1)
x<-c(1:10)
x
sample(x,5)
x1<-sample(x,5)
x1
x-x1
x %in% x1
x[x %in% x1]
x[!(x %in% x1)]
x1
test = list()
test[1] = c(1,2)
test[1] <- c(1,2)
test[1] <- list()
test[1] <- list(5)
test[1]
x
x1 <- c(c(1,3), c(4,6), c(9))
x1
x1 <- c(list(c(1,3)), c(4,6), c(9))
x1
x1 <- c(list(c(1,3)), list(c(4,6)), list(c(9)))
x1
x
x[!(x %in% x1)]
x[!(x %in% x1[[1]])]
x[!(x %in% x1[[1:3]])]
x2 <- x1
x2
?unpack
x2 <- lapply(x1, function(x) x)
x2
x2 <- lapply(x1, function(x) c(x))
x2
x[!(x %in% lapply(x1, function(x) x))]
x2 <- lapply(x1, function(x) for (i in 1:length(x)) {c(x[[i]])})
x2
lapply(x1, function(x) for (i in 1:length(x)) {c(x[[i]])})
x1
for (value in x1){value}
for (value in x1){return(value)}
for (value in x1){print(value)}
x2 <- (for (value in x1){(value)})
x2
x2 <- (for (value in x1){return(value)})
x2
x2 <- (for (value in x1){print(value)})
x2
for (value in x1){x2 <- c(value)}
x2
for (value in x1){x2.append(value)}
?append
unlist(x1)
x[!(x %in% unlist(x1)]
x[!(x %in% unlist(x1))]
x3 <- list()
unlist(x3)
x[!(x %in% unlist(x3))]
x=10
x[!(x %in% unlist(x3))]
1:x[!(x %in% unlist(x3))]
1:x[!(x %in% unlist(x1))]
x1
(1:x)[!(x %in% unlist(x1))]
(1:x)[!(1:x %in% unlist(x1))]
x[!(1:x %in% unlist(x1))]
1:x[!(1:x %in% unlist(x1))]
(1:x)[!(1:x %in% unlist(x1))]
(1:x)[!(1:x %in% unlist(x3))]
library(tswge)
gen.aruma.wge(n=500, phi=0, theta=0, s=7, sn=100)
gen.aruma.wge(n=500, phi=0, theta=0, s=7, sn=2019)
library(readr)
AGNC <- read_csv("C:/Users/anhai/Desktop/SMU/6373_Time_Series/6/AGNC.csv")
View(AGNC)
plotts.sample.wge(AGNC$Close)
AGNC_diff <- artrans.wge(AGNC$Close, 1)
plotts.sample.wge(AGNC_diff)
?atrans.wge
?artrans.wge
artrans.wge(AGNC$Close, 1)
?plotts.sample.wge
?artrans.wge
aic5.wge(AGNC$Close)
aic5.wge(AGNC_diff)
aic5.wge(AGNC_diff, q=0:4)
aic5.wge(AGNC_diff, p=0:6)
library(rpart)
data("iris")
iris
?rpart.plot
library(rpart.plot)
?rpart
data("iris")
install.packages("rpart.plot")
library(rpart.plot)
?rpart.plot
rpart.plot(iris)
head(iris)
iris_ <- rpart(iris$Species ~ ., iris)
rpart.plot(iris_)
?rpart.plot
?rpart
?rpart.control
iris_ <- rpart(iris$Species ~ ., iris, control = rpart.control(cp = 0.05))
rpart.plot(iris_)
plotcp(iris_)
iris_ <- rpart(iris$Species ~ ., iris
)
plotcp(iris_)
iris_cp <- rpart(iris$Species ~ ., iris, control = rpart.control(cp = 0.066))
plotcp(iris_cp)
rpart.plot(iris_cp)
rpart.plot(iris_)
iris_cp_0.1 <- rpart(iris$Species ~ ., iris, control = rpart.control(cp = 0.1))
rpart.plot(iris_cp_0.1)
iris_cp_1 <- rpart(iris$Species ~ ., iris, control = rpart.control(cp = 1))
rpart.plot(iris_cp_1)
iris_cp_0.4 <- rpart(iris$Species ~ ., iris, control = rpart.control(cp = .4))
rpart.plot(iris_cp_0.4)
library(tswge)
?gen.sigplusnoise.wge
gen.sigplusnoise.wge(n=100,coef=c(3,1),freq=c(.1,.4),psi=c(0,0),vara=2)
gen.sigplusnoise.wge(n=100,coef=c(3,1),freq=c(.1,.4),psi=c(0,0),vara=2)
gen.sigplusnoise.wge(n=100,coef=c(3,1),freq=c(.1,.4),psi=c(0,0),vara=2)
library(readr)
AGNC <- read_csv("C:/Users/anhai/Desktop/SMU/6373_Time_Series/6/AGNC.csv")
View(AGNC)
library(tswge)
plotts.sample.wge(AGNC$Close)
AGNC_1 <- artrans.wge(AGNC$Close, 1)
factor.wge(phi=c(.76, 0,0,.94, -.75))
factor.wge(phi=c(0,0,0,0,1)
)
factor.wge(phi=c(0,0,0,1))
factor.wge(phi=c(.76, 0,0,.94, -.75))
factor.wge(c(0.1, 0.72, -0.016, -0.29, 0.02, 0.144, -0.0032, 0.0621, -0.008, -0.058,  0.00128, 0.0072))
factor.wge(phi=c(rep(0,11),1))
factor.wge(c(0.1, 0.72, -0.016, -0.29, 0.02, 0.144, -0.0032, 0.0621, -0.008, -0.058,  0.00128, 0.0072))
factor.wge(phi=c(rep(0,19),1))
setwd("C:/Users/anhai/Desktop/SMU/7333_QTW/7333_QTW/Case_Study_6")
setwd("C:/Users/anhai/Desktop/SMU/7333_QTW/7333_QTW/Case_Study_6")
spamPath = "./SpamAssassinMessages/"
dirNames = list.files(path = paste(spamPath, "messages",  sep = .Platform$file.sep))
fullDirNames = paste(spamPath, "messages", dirNames, sep = .Platform$file.sep)
splitMessage = function(msg) {
splitPoint = match("", msg)
header = msg[1:(splitPoint-1)]
body = msg[ -(1:splitPoint) ]
return(list(header = header, body = body))
}
getBoundary = function(header) {
boundaryIdx = grep("boundary=", header)
boundary = gsub('"', "", header[boundaryIdx])
gsub(".*boundary= *([^;]*);?.*", "\\1", boundary)
}
dropAttach = function(body, boundary){
bString = paste("--", boundary, sep = "")
bStringLocs = which(bString == body)
if (length(bStringLocs) <= 1) return(body)
eString = paste("--", boundary, "--", sep = "")
eStringLoc = which(eString == body)
if (length(eStringLoc) == 0)
return(body[ (bStringLocs[1] + 1) : (bStringLocs[2] - 1)])
n = length(body)
if (eStringLoc < n)
return( body[ c( (bStringLocs[1] + 1) : (bStringLocs[2] - 1),
( (eStringLoc + 1) : n )) ] )
return( body[ (bStringLocs[1] + 1) : (bStringLocs[2] - 1) ])
}
library(tm)
stopWords = stopwords()
cleanSW = tolower(gsub("[[:punct:]0-9[:blank:]]+", " ", stopWords))
SWords = unlist(strsplit(cleanSW, "[[:blank:]]+"))
SWords = SWords[ nchar(SWords) > 1 ]
stopWords = unique(SWords)
cleanText =
function(msg)   {
tolower(gsub("[[:punct:]0-9[:space:][:blank:]]+", " ", msg))
}
findMsgWords =
function(msg, stopWords) {
if(is.null(msg))
return(character())
words = unique(unlist(strsplit(cleanText(msg), "[[:blank:]\t]+")))
# drop empty and 1 letter words
words = words[ nchar(words) > 1]
words = words[ !( words %in% stopWords) ]
invisible(words)
}
processAllWords = function(dirName, stopWords)
{
# read all files in the directory
fileNames = list.files(dirName, full.names = TRUE)
# drop files that are not email, i.e., cmds
notEmail = grep("cmds$", fileNames)
if ( length(notEmail) > 0) fileNames = fileNames[ - notEmail ]
messages = lapply(fileNames, readLines, encoding = "latin1")
# split header and body
emailSplit = lapply(messages, splitMessage)
# put body and header in own lists
bodyList = lapply(emailSplit, function(msg) msg$body)
headerList = lapply(emailSplit, function(msg) msg$header)
rm(emailSplit)
# determine which messages have attachments
hasAttach = sapply(headerList, function(header) {
CTloc = grep("Content-Type", header)
if (length(CTloc) == 0) return(0)
multi = grep("multi", tolower(header[CTloc]))
if (length(multi) == 0) return(0)
multi
})
hasAttach = which(hasAttach > 0)
# find boundary strings for messages with attachments
boundaries = sapply(headerList[hasAttach], getBoundary)
# drop attachments from message body
bodyList[hasAttach] = mapply(dropAttach, bodyList[hasAttach],
boundaries, SIMPLIFY = FALSE)
# extract words from body
msgWordsList = lapply(bodyList, findMsgWords, stopWords)
invisible(msgWordsList)
}
msgWordsList = lapply(fullDirNames, processAllWords,
stopWords = stopWords)
numMsgs = sapply(msgWordsList, length)
numMsgs
isSpam = rep(c(FALSE, FALSE, FALSE, TRUE, TRUE), numMsgs)
msgWordsList = unlist(msgWordsList, recursive = FALSE)
numEmail = length(isSpam)
numSpam = sum(isSpam)
numHam = numEmail - numSpam
set.seed(418910)
#number of folds to produce
fold = 5
#initialize lists of indexes
foldSpamIdx = list()
foldHamIdx = list()
#create a list of x folds holding a list of indexes
#sample() will not sample indexes that have already been taken for previous folds
for (x in 1:fold){
foldSpamIdx[x] = list(sample((1:numSpam)[!((1:numSpam) %in% unlist(foldSpamIdx))], size = floor(numSpam/fold)))
foldHamIdx[x] = list(sample((1:numHam)[!((1:numHam) %in% unlist(foldHamIdx))], size = floor(numHam/fold)))
}
computeFreqs =
function(wordsList, spam, bow = unique(unlist(wordsList)))
{
# create a matrix for spam, ham, and log odds
wordTable = matrix(0.5, nrow = 4, ncol = length(bow),
dimnames = list(c("spam", "ham",
"presentLogOdds",
"absentLogOdds"),  bow))
# For each spam message, add 1 to counts for words in message
counts.spam = table(unlist(lapply(wordsList[spam], unique)))
wordTable["spam", names(counts.spam)] = counts.spam + .5
# Similarly for ham messages
counts.ham = table(unlist(lapply(wordsList[!spam], unique)))
wordTable["ham", names(counts.ham)] = counts.ham + .5
# Find the total number of spam and ham
numSpam = sum(spam)
numHam = length(spam) - numSpam
# Prob(word|spam) and Prob(word | ham)
wordTable["spam", ] = wordTable["spam", ]/(numSpam + .5)
wordTable["ham", ] = wordTable["ham", ]/(numHam + .5)
# log odds
wordTable["presentLogOdds", ] =
log(wordTable["spam",]) - log(wordTable["ham", ])
wordTable["absentLogOdds", ] =
log((1 - wordTable["spam", ])) - log((1 -wordTable["ham", ]))
invisible(wordTable)
}
#create a list of word table, 1 for each fold as the test set
trainTable = list()
testMsgWords = list()
testIsSpam = list()
trainIsSpam = list()
for (x in 1:fold){
testSpamIdx = foldSpamIdx[[x]]
testHamIdx = foldHamIdx[[x]]
testMsgWords[[x]] = c((msgWordsList[isSpam])[testSpamIdx],
(msgWordsList[!isSpam])[testHamIdx] )
trainMsgWords = c((msgWordsList[isSpam])[ - testSpamIdx],
(msgWordsList[!isSpam])[ - testHamIdx])
testIsSpam[[x]] = rep(c(TRUE, FALSE),
c(length(testSpamIdx), length(testHamIdx)))
trainIsSpam[[x]] = rep(c(TRUE, FALSE),
c(numSpam - length(testSpamIdx),
numHam - length(testHamIdx)))
trainTable[[x]] = list(computeFreqs(trainMsgWords, trainIsSpam[[x]]))
}
computeMsgLLR = function(words, freqTable)
{
# Discards words not in training data.
words = words[!is.na(match(words, colnames(freqTable)))]
# Find which words are present
present = colnames(freqTable) %in% words
sum(freqTable["presentLogOdds", present]) +
sum(freqTable["absentLogOdds", !present])
}
length(trainTable[[1]][[1]])
length(colnames(trainTable[[1]][[1]]))
testLLR = sapply(testMsgWords[[1]], computeMsgLLR, trainTable[[1][[1]]])
testLLR = sapply(testMsgWords[[1]], computeMsgLLR, trainTable[[1]][[1]])
tapply(testLLR, testIsSpam[[1]], summary)
